<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∞ —Ä—ã–±–æ–ª–æ–≤–Ω—ã—Ö –º–µ—Å—Ç - –ú–∏—Ö–∞–ª—ã—á</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        body { margin: 0; padding: 0; }
        #map { height: 100vh; width: 100%; }
        .balloon { max-width: 300px; }
        .balloon img { max-width: 100%; height: auto; }
        .balloon-title { font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
        const map = L.map('map').setView([55.7558, 37.6173], 5); // –¶–µ–Ω—Ç—Ä –Ω–∞ –ú–æ—Å–∫–≤–µ
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª–æ–π –∫–∞—Ä—Ç—ã
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
        }).addTo(map);

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–∞—Ö
        fetch('./places.json')
            .then(response => response.json())
            .then(places => {
                places.forEach(place => {
                    const { coords, description, photo_url, source_link } = place;
                    
                    // –°–æ–∑–¥–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–∞–ª—É–Ω–∞
                    let balloonContent = `
                        <div class="balloon">
                            <div class="balloon-title">üé£ –ú–µ—Å—Ç–æ –¥–ª—è —Ä—ã–±–∞–ª–∫–∏</div>
                            <div class="balloon-description">${description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</div>
                    `;
                    
                    if (photo_url) {
                        balloonContent += `
                            <div class="balloon-photo">
                                <img src="${photo_url}" alt="–§–æ—Ç–æ –º–µ—Å—Ç–∞" />
                            </div>
                        `;
                    }
                    
                    if (source_link) {
                        balloonContent += `
                            <div class="balloon-source">
                                <a href="${source_link.url}" target="_blank">${source_link.text}</a>
                            </div>
                        `;
                    }
                    
                    balloonContent += `</div>`;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä –Ω–∞ –∫–∞—Ä—Ç—É
                    L.marker(coords)
                        .addTo(map)
                        .bindPopup(balloonContent);
                });
                
                console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${places.length} —Ç–æ—á–µ–∫ –¥–ª—è —Ä—ã–±–∞–ª–∫–∏`);
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
            });
    </script>
</body>
</html>